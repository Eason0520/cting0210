## 第一问：进程和线程

本质：进程和线程的区别就像房子跟房间的关系和区别。

**房子和房间**

  房子和房间的区别，无论房子还是房间最根本的目的是住人； 无论进程还是线程，最根本的目的是处理事情。 

  进程是操作系统资源分配（内存，显卡，磁盘）的最小单位，线程是执行调度（即cpu调度）的最小单位（cpu看到的都是线程而不是进程）。

  如何记忆进程和线程？在疫情期间，物业发放资源，是按照房子来发放的，肯定不是按照房间来发放，这个也就是资源分配。调度是什么，当然如果你一个包租婆肯定单租利益最大化，那就是按照房间来进行。 

**优点和缺点**

  进程的优势在于什么呢？ 稳定，多进程不会 有影响；缺点是不灵活，使用成本高。

  线程的优势在于？灵活，使用成本低；缺点在于不稳定，一个线程可能会阻塞其他的线程正常进行。

  对于房间和房子的区别是不是好理解了。房子的隔离性好；而房间比较灵活，好出租。 

**如何选择**

  nginx用的是多进程而不是多线程。原因是什么？nginx是用的多进程的方式，目的就是为了稳定。如何你的程序对稳定性要求特别高就需要使用多进程了，nginx作为流量入口，必然要求非常高的稳定性。

  日常的程序一般是多线程，因为部署在了多台机器上，实现了分布式的管理。就算挂一个实例，影响其实是可控的。

**面试考察点**

  稳定和灵活之前需要兼容，一般都是多线程，如果是一个更稳定的要求就需要多进程，反过来来再看这个表格是不是就好理解了。对应到房子跟房间的关系和区别：

|          | 进程                                                         | 线程                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 资源分配 | 是系统进行资源分配和调度的基本单位                           | 继承和共享进程的资源，不能单独的分配                         |
| 调度方式 | 子进程与父进程平等竞争                                       | 子线程与父线程平等竞争                                       |
| 通信方式 | A.共享内存  B.消息队列  C.信号量  D.有名管道  E.无名管道  F.信号 G.文件 H.socket | A.互斥量   B.自旋锁   C.条件变量 D.读写锁   E.线程信号 G.全局变量 |
|          | 进程间采用的通信方式要么需要**切换内核上下文**，所以速度会比较慢。 | 基本都在自己的进程空间内完成，不存在切换，所以通信速度会较快。 |
| 稳定性   | 进程之间资源和空间相对独立，所有一个进程挂了不会影响到其他的进展，稳定性要好，比如nginx采用的就是多进程的模式 | 线程资源共享资源，一个线程如果对公共资源有影响，比如越栈，溢出，core等就会对其他线程产生影响。 |
| 实现     | 复杂                                                         | 简单                                                         |

## 第二问：idle和load